@page "/mainpage/{id}"
@using BookCatalog.Core.Web.Models
@using BookCatalog.Core.Web.Models.DTOs.Book
@inject HttpClient HttpClient

<h3>Book Detail</h3>

@if (book is not null)
{
    <p><strong>Title:</strong> @book.Name</p>
    <p><strong>ISBN:</strong> @book.ISBN</p>
    <p><strong>Description:</strong> @book.Description</p>
    <p><strong>Published Date:</strong> @book.PublishedDate.ToString("yyyy-MM-dd")</p>
    <!-- You can add more fields as necessary -->
}
else
{
    <p>Loading book details...</p>
}

@code {
    [Parameter]
    public string Id { get; set; }  // Changed from string to int

    private GetAllBooksDTO book;  // Changed from List<Book> to Book

    protected override async Task OnParametersSetAsync()
    {
        try
        {
            // Fetching a single book instead of a list
            book = await HttpClient.GetFromJsonAsync<GetAllBooksDTO>($"https://localhost:7282/api/Book/GetBookById/{this.Id}");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error fetching book details: {ex.Message}");
        }
    }
}
